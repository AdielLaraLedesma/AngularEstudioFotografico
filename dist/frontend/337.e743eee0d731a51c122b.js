"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[337],{5337:(X,f,a)=>{a.r(f),a.d(f,{FotografoModule:()=>W});var p=a(8583),l=a(4655),_=a(6343),Z=a(6823),c=a(3679),T=a(9765),x=a(5319),b=a(6782),d=a(2340),e=a(7716),h=a(1841),F=a(205),g=a(8002),m=a(5304),A=a(9344);let C=(()=>{class i{constructor(t,o){this.http=t,this.toastr=o}getServicios(t){return this.http.get(`${d.N.baseUrl}/servicios_evento/byFotografo/${t}`).pipe((0,g.U)(o=>o),(0,m.K)(o=>this.handlerError(o)))}getServicio(t){return this.http.get(`${d.N.baseUrl}/servicios_evento/${t}`).pipe((0,g.U)(o=>o),(0,m.K)(o=>this.handlerError(o)))}updateImg(t,o){return this.http.put(`${d.N.baseUrl}/servicios_evento/subir_imagenes/${t}`,o).pipe((0,g.U)(n=>n),(0,m.K)(n=>this.handlerError(n)))}updateVideo(t,o){const n=new h.WM;return n.append("Content-Type","application/json"),n.append("Access-Control-Allow-Origin","http://angular-proyecto-integrador.s3-website-us-west-1.amazonaws.com/"),this.http.put(`${d.N.baseUrl}/servicios_evento/subir_videos/${t}`,o,{headers:n}).pipe((0,g.U)(s=>s),(0,m.K)(s=>this.handlerError(s)))}getImages(t){return this.http.get(`${d.N.baseUrl}/servicios_evento/imagenes/${t}`).pipe((0,g.U)(o=>o),(0,m.K)(o=>this.handlerError(o)))}getVideos(t){const o=new h.WM;return o.append("Content-Type","application/json"),o.append("Access-Control-Allow-Headers","application/json"),this.http.get(`${d.N.baseUrl}/servicios_evento/videos/${t}`,{headers:o}).pipe((0,g.U)(n=>n),(0,m.K)(n=>this.handlerError(n)))}handlerError(t){let o="An errror occured retrienving data";return t&&(o=`Error: code ${t.message}`),this.toastr.error(o),(0,F._)(o)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(h.eN),e.LFG(A._W))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var q=a(8060),U=a(6627),y=a(1095);function E(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"img",19),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(2).removeImagen(s)}),e.qZA()}2&i&&e.Q6J("src",r.$implicit,e.LSH)}function w(i,r){if(1&i&&(e.TgZ(0,"div",15),e.TgZ(1,"div",5),e.TgZ(2,"div",6),e.TgZ(3,"div",7),e.TgZ(4,"div",8),e.TgZ(5,"h3",16),e._uU(6,"Imagenes seleccionadas"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"div",11),e.TgZ(8,"div",2),e.TgZ(9,"div",17),e.YNc(10,E,1,1,"img",18),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(10),e.Q6J("ngForOf",t.imagesHtml)}}function M(i,r){if(1&i&&(e.TgZ(0,"h3",16),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.servicioEvento.paquete_nombre)}}function O(i,r){if(1&i&&(e.TgZ(0,"h3"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t.servicioEvento.estatus_nombre)}}function I(i,r){if(1&i&&(e.TgZ(0,"span"),e.TgZ(1,"mat-icon"),e._uU(2,"calendar_today"),e.qZA(),e._uU(3),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.hij(" Fecha del evento : ",t.servicioEvento.fecha_evento," ")}}function S(i,r){if(1&i&&(e.TgZ(0,"span"),e.TgZ(1,"mat-icon"),e._uU(2,"place"),e.qZA(),e._uU(3),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.hij(" Direccion : ",t.servicioEvento.direccion," ")}}function D(i,r){if(1&i&&(e.TgZ(0,"span"),e.TgZ(1,"mat-icon"),e._uU(2,"face"),e.qZA(),e._uU(3),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.hij(" Nombre del cliente : ",t.servicioEvento.nombre_cliente," ")}}function N(i,r){if(1&i&&(e.TgZ(0,"span"),e.TgZ(1,"mat-icon"),e._uU(2,"call"),e.qZA(),e._uU(3),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.hij(" Telefono del cliente : ",t.servicioEvento.celular_cliente," ")}}function P(i,r){if(1&i&&(e.TgZ(0,"span"),e.TgZ(1,"mat-icon"),e._uU(2,"image"),e.qZA(),e._uU(3),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.hij(" Fotos digitales : ",t.servicioEvento.no_Fotos_Dig," ")}}function Y(i,r){if(1&i&&(e.TgZ(0,"span"),e.TgZ(1,"mat-icon"),e._uU(2,"image"),e.qZA(),e._uU(3),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.hij(" Fotos enmarcadas : ",t.servicioEvento.no_Fotos_Enm," ")}}function H(i,r){if(1&i&&(e.TgZ(0,"span"),e.TgZ(1,"mat-icon"),e._uU(2,"image"),e.qZA(),e._uU(3),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.hij(" Fotos fisicas : ",t.servicioEvento.no_Fotos_Fis," ")}}function J(i,r){if(1&i&&(e.TgZ(0,"span"),e.TgZ(1,"mat-icon"),e._uU(2,"credit_card"),e.qZA(),e._uU(3),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.hij(" El total es : ",t.servicioEvento.total," ")}}function $(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"form",20),e.NdJ("ngSubmit",function(){return e.CHM(t),e.oxw().agregarMultimedia()}),e.TgZ(2,"div",13),e.TgZ(3,"div",12),e.TgZ(4,"div",21),e.TgZ(5,"input",22),e.NdJ("change",function(n){return e.CHM(t),e.oxw().onImageSelected(n)}),e.qZA(),e.TgZ(6,"label",23),e.TgZ(7,"mat-icon",24),e._uU(8,"add"),e.qZA(),e._uU(9,"Seleccionar imagenes "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(10,"div",12),e.TgZ(11,"div",21),e.TgZ(12,"input",25),e.NdJ("change",function(n){return e.CHM(t),e.oxw().onVideoSelected(n)}),e.qZA(),e.TgZ(13,"label",26),e.TgZ(14,"mat-icon",24),e._uU(15,"add"),e.qZA(),e._uU(16,"Seleccionar video "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(17,"div",27),e.TgZ(18,"button",28),e._uU(19," Guardar cambios "),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.agregarImagenesVideoForm),e.xp6(17),e.Q6J("disabled",t.agregarImagenesVideoForm.invalid)}}function Q(i,r){if(1&i&&(e.TgZ(0,"video",31),e._UZ(1,"source",32),e.qZA()),2&i){const t=r.$implicit;e.xp6(1),e.Q6J("src",t,e.LSH)}}function j(i,r){if(1&i&&(e.TgZ(0,"div",29),e.TgZ(1,"div",5),e.TgZ(2,"div",6),e.TgZ(3,"div",7),e.TgZ(4,"div",8),e.TgZ(5,"h3",16),e._uU(6,"Videos seleccionados"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"div",11),e.TgZ(8,"div",2),e.TgZ(9,"div",17),e.YNc(10,Q,2,1,"video",30),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(10),e.Q6J("ngForOf",t.videosHtml)}}function L(i,r){if(1&i&&(e.TgZ(0,"div",3),e.TgZ(1,"div",4),e.TgZ(2,"h2"),e._uU(3),e.qZA(),e.qZA(),e.TgZ(4,"div",5),e.TgZ(5,"h3",6),e._uU(6),e.qZA(),e.TgZ(7,"h3",7),e._uU(8),e.qZA(),e.qZA(),e.qZA()),2&i){const t=r.$implicit,o=e.oxw();e.MGl("routerLink","/fotografo/servicios/detalle/",t.id,""),e.xp6(1),e.Udp("border-color",o.getColor(t.estatus_nombre)),e.xp6(1),e.Udp("color",o.getColor(t.estatus_nombre)),e.xp6(1),e.Oqu(t.nombre_cliente),e.xp6(3),e.Oqu(t.paquete_nombre),e.xp6(2),e.hij(" ",t.estatus_nombre," ")}}const R=[{path:"",children:[{path:"detalle/:id",component:(()=>{class i{constructor(t,o,n,s,u,v){this._rutaActiva=t,this._fotografoService=o,this._authService=n,this._toastr=s,this._router=u,this.http=v,this.url=d.N.url,this.contador=0,this.id="",this.servicioEvento={id:0,cliente_id:0,fotografo_id:0,paquete_id:0,fecha_evento:new Date,direccion:"",marco_id:0,total:0,estatus_id:0,pago_id:0,activo:!1,usuario_registro_id:0,fecha_registro:0,nombre_cliente:"",paquete_nombre:"",estatus_nombre:"",no_Fotos_Dig:0,no_Fotos_Enm:0,no_Fotos_Fis:0,celular_cliente:""},this.destroy$=new T.xQ,this.user=null,this.subscription=new x.w,this.images=[],this.imagesHtml=[],this.videoCollection=[],this.videoCollectionSafe=[],this.videos=[],this.videosHtml=[],this.agregarImagenesVideoForm=new c.cw({files:new c.NI,usuario_modificacion_id:new c.NI("",[c.kI.required])})}ngOnDestroy(){this.subscription.unsubscribe(),this.destroy$.next({}),this.destroy$.complete()}ngOnInit(){this.getUser(),this.id=this._rutaActiva.snapshot.params.id,this.subscription.add(this._fotografoService.getServicio(this.id).subscribe(t=>{t||this._router.navigate([`/fotografo/detalle/${this.id}`]),this.servicioEvento=t})),this.subscription.add(this._fotografoService.getImages(this.id).subscribe(t=>{t.forEach(o=>{this.imagesHtml.push(this.url+o.url_imagen)})})),this.subscription.add(this._fotografoService.getVideos(this.id).subscribe(t=>{for(var o=0;o<t.length;o++)this.videosHtml.push(this.url+t[o].url_video)}))}removeImagen(t){for(var o=0;o<this.images.length;o++)this.imagesHtml[o]===t&&(this.imagesHtml.splice(o,1),this.images.splice(o,1),o--)}agregarMultimedia(){var t,o;const n=new FormData;n.append("usuario_modificacion_id",null===(t=this.agregarImagenesVideoForm.get("usuario_modificacion_id"))||void 0===t?void 0:t.value);for(var s=0;s<this.images.length;s++)n.append("image",this.images[s]);this._fotografoService.updateImg(this.id,n).subscribe(v=>{this._toastr.success("Se han agregado las imagenes correctamente","Imagenes agregadas",{positionClass:"toast-bottom-right"})});const u=new FormData;for(u.append("usuario_modificacion_id",null===(o=this.agregarImagenesVideoForm.get("usuario_modificacion_id"))||void 0===o?void 0:o.value),s=0;s<this.videos.length;s++)u.append("video",this.videos[s]);this._fotografoService.updateVideo(this.id,u).subscribe(v=>{this._toastr.success("Se han agregado los videos correctamente","Videos agregadas",{positionClass:"toast-bottom-right"}),this._router.navigate([`/fotografo/detalle/${this.id}`])})}getUser(){this.user=this._authService.getUser(),null==this.user&&this.subscription.add(this._authService.user$.pipe((0,b.R)(this.destroy$)).subscribe(t=>{t&&(this.user=t)}))}onImageSelected(t){this.agregarImagenesVideoForm.controls.usuario_modificacion_id.setValue(this.user.id);for(var o=0;o<t.target.files.length;o++){this.images.push(t.target.files[o]);const n=new FileReader;n.onload=s=>{this.imagesHtml.push(s.target.result)},n.readAsDataURL(t.target.files[o])}}onVideoSelected(t){this.agregarImagenesVideoForm.controls.usuario_modificacion_id.setValue(this.user.id);for(var o=0;o<t.target.files.length;o++){this.videos.push(t.target.files[o]);var n=new FileReader;n.onload=s=>{this.videosHtml.push(s.target.result)},n.readAsDataURL(t.target.files[o])}}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(l.gz),e.Y36(C),e.Y36(q.e),e.Y36(A._W),e.Y36(l.F0),e.Y36(h.eN))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-detalle"]],decls:34,vars:19,consts:[[1,"main-content"],[1,"container","mt-4"],[1,"row"],["class","col-xl-3 order-xl-1 mb-3",4,"ngIf"],[1,"order-xl-1","mb-3"],[1,"card","bg-secondary","shadow"],[1,"card-header","bg-white","border-0"],[1,"row","align-items-center"],[1,"col-12","header"],["class","mb-0",4,"ngIf"],[4,"ngIf"],[1,"card-body"],[1,"col-lg-6"],[1,"row","mt-4"],["class","col-xl-3 order-xl-1",4,"ngIf"],[1,"col-xl-3","order-xl-1","mb-3"],[1,"mb-0"],[1,"col-lg-12"],["class","img-form","style","margin: 3px; cursor: pointer;","placement","bottom","ngbTooltip","Eliminar imagen",3,"src","click",4,"ngFor","ngForOf"],["placement","bottom","ngbTooltip","Eliminar imagen",1,"img-form",2,"margin","3px","cursor","pointer",3,"src","click"],[3,"formGroup","ngSubmit"],[1,"form-group","focused"],["multiple","","id","img","accept","image/*","type","file",1,"hiden",2,"display","none",3,"change"],["for","img",1,"btn","btn-outline-primary"],[2,"font-size","20px !important"],["multiple","","id","vid","accept","video/*","type","file",1,"hiden",2,"display","none",3,"change"],["for","vid",1,"btn","btn-outline-primary"],[1,"row","mt-2"],["mat-raised-button","","type","submit","color","primary",2,"width","80%","margin","auto",3,"disabled"],[1,"col-xl-3","order-xl-1"],["width","200","height","200","controls","",4,"ngFor","ngForOf"],["width","200","height","200","controls",""],["type","video/mp4",3,"src"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.YNc(3,w,11,1,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",5),e.TgZ(6,"div",6),e.TgZ(7,"div",7),e.TgZ(8,"div",8),e.YNc(9,M,2,1,"h3",9),e.YNc(10,O,2,1,"h3",10),e.qZA(),e.qZA(),e.qZA(),e.TgZ(11,"div",11),e.TgZ(12,"div",2),e.TgZ(13,"div",12),e.YNc(14,I,4,1,"span",10),e.qZA(),e.TgZ(15,"div",12),e.YNc(16,S,4,1,"span",10),e.qZA(),e.qZA(),e.TgZ(17,"div",13),e.TgZ(18,"div",12),e.YNc(19,D,4,1,"span",10),e.qZA(),e.TgZ(20,"div",12),e.YNc(21,N,4,1,"span",10),e.qZA(),e.qZA(),e.TgZ(22,"div",13),e.TgZ(23,"div",12),e.YNc(24,P,4,1,"span",10),e.qZA(),e.TgZ(25,"div",12),e.YNc(26,Y,4,1,"span",10),e.qZA(),e.qZA(),e.TgZ(27,"div",13),e.TgZ(28,"div",12),e.YNc(29,H,4,1,"span",10),e.qZA(),e.TgZ(30,"div",12),e.YNc(31,J,4,1,"span",10),e.qZA(),e.qZA(),e.YNc(32,$,20,2,"div",10),e.qZA(),e.qZA(),e.qZA(),e.YNc(33,j,11,1,"div",14),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",0!=o.imagesHtml.length),e.xp6(1),e.ekj("col-xl-6",0!=o.videosHtml.length&&0!=o.imagesHtml.length)("col-xl-12",0==o.videosHtml.length&&0==o.imagesHtml.length)("col-xl-9",0==o.videosHtml.length||0==o.imagesHtml.length),e.xp6(5),e.Q6J("ngIf",null!=o.servicioEvento),e.xp6(1),e.Q6J("ngIf",null!=o.servicioEvento),e.xp6(4),e.Q6J("ngIf",null!=o.servicioEvento),e.xp6(2),e.Q6J("ngIf",null!=o.servicioEvento),e.xp6(3),e.Q6J("ngIf",null!=o.servicioEvento),e.xp6(2),e.Q6J("ngIf",null!=o.servicioEvento),e.xp6(3),e.Q6J("ngIf",null!=o.servicioEvento),e.xp6(2),e.Q6J("ngIf",null!=o.servicioEvento),e.xp6(3),e.Q6J("ngIf",null!=o.servicioEvento),e.xp6(2),e.Q6J("ngIf",null!=o.servicioEvento),e.xp6(1),e.Q6J("ngIf",null!=o.servicioEvento&&"En espera de interaccion del fotografo"==o.servicioEvento.estatus_nombre),e.xp6(1),e.Q6J("ngIf",0!=o.videosHtml.length))},directives:[p.O5,p.sg,U.Hw,c._Y,c.JL,c.sg,y.lW],styles:[".card[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;min-width:0;word-wrap:break-word;border:1px solid rgba(0,0,0,.05);border-radius:.375rem;background-color:#fff;background-clip:border-box}.card[_ngcontent-%COMP%] > hr[_ngcontent-%COMP%]{margin-right:0;margin-left:0}.card-body[_ngcontent-%COMP%]{padding:1.5rem;flex:1 1 auto}.bg-secondary[_ngcontent-%COMP%]{background-color:#f7fafc!important}a.bg-secondary[_ngcontent-%COMP%]:hover, a.bg-secondary[_ngcontent-%COMP%]:focus, button.bg-secondary[_ngcontent-%COMP%]:hover, button.bg-secondary[_ngcontent-%COMP%]:focus{background-color:#d2e3ee!important}.mt-4[_ngcontent-%COMP%]{margin-top:4rem!important}h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h6[_ngcontent-%COMP%]{margin-top:0;margin-bottom:.5rem}h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h6[_ngcontent-%COMP%], .h2[_ngcontent-%COMP%], .h3[_ngcontent-%COMP%], .h6[_ngcontent-%COMP%]{font-family:inherit;font-weight:600;line-height:1.5;margin-bottom:.5rem;color:#32325d}h2[_ngcontent-%COMP%], .h2[_ngcontent-%COMP%]{font-size:1.25rem}h3[_ngcontent-%COMP%], .h3[_ngcontent-%COMP%]{font-size:1.0625rem}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.img-form[_ngcontent-%COMP%]{height:50px;max-width:400px}"]}),i})(),canActivate:[Z.X,_._]},{path:":id",component:(()=>{class i{constructor(t,o,n,s){this._rutaActiva=t,this._authService=o,this._fotografoService=n,this._router=s,this.id="",this.destroy$=new T.xQ,this.user=null,this.subscription=new x.w}ngOnInit(){this.getUser(),this.id=this._rutaActiva.snapshot.params.id,this.user.id.toString()==this.id?this.subscription.add(this._fotografoService.getServicios(this.id).subscribe(t=>{this.servicioEventos=t})):this._router.navigate(["/home"])}ngOnDestroy(){this.subscription.unsubscribe()}getUser(){this.user=this._authService.getUser(),null==this.user&&this.subscription.add(this._authService.user$.pipe((0,b.R)(this.destroy$)).subscribe(t=>{t&&(this.user=t)}))}getColor(t){switch(t){case"Solicitado/Agendado":return"violet";case"En espera del evento":return"naviblue";case"En espera de interaccion del fotografo":return"marron";case"En espera de interaccion del cliente":return"purple";case"Finalizando pedido":return"pink";case"Finalizado":return"green";default:return"black"}}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(l.gz),e.Y36(q.e),e.Y36(C),e.Y36(l.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-listado"]],decls:3,vars:1,consts:[[1,"main-content"],[1,"container"],["class","card mt-3",3,"routerLink",4,"ngFor","ngForOf"],[1,"card","mt-3",3,"routerLink"],[1,"card-header"],[1,"card-body"],[1,"card-title"],[1,"card-text"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.YNc(2,L,9,8,"div",2),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngForOf",o.servicioEventos))},directives:[p.sg,l.rH],styles:[".mt-3[_ngcontent-%COMP%]{margin-top:3rem!important}.card-header[_ngcontent-%COMP%]{border-width:1px;border-style:solid}.card-body[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.card[_ngcontent-%COMP%]:hover{cursor:pointer}"]}),i})(),canActivate:[Z.X,_._]}]}];let G=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[l.Bz.forChild(R)],l.Bz]}),i})();var K=a(9731);let W=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[p.ez,G,K.q,c.u5,c.UX]]}),i})()}}]);